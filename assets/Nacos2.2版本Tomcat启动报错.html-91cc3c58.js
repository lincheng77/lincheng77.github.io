import{_ as a,W as n,X as e,a2 as t}from"./framework-6199cc12.js";const s={},o=t(`<h1 id="nacos2-2版本tomcat启动报错" tabindex="-1"><a class="header-anchor" href="#nacos2-2版本tomcat启动报错" aria-hidden="true">#</a> Nacos2.2版本Tomcat启动报错</h1><h2 id="错误日志" tabindex="-1"><a class="header-anchor" href="#错误日志" aria-hidden="true">#</a> 错误日志</h2><p>查看 logs/start.out，可以看到报错信息</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">2023</span>-04-09 <span class="token number">19</span>:36:23,081 ERROR Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name <span class="token string">&#39;basicAuthenticationFilter&#39;</span> defined <span class="token keyword">in</span> class path resource <span class="token punctuation">[</span>com/alibaba/nacos/prometheus/filter/PrometheusAuthFilter.class<span class="token punctuation">]</span>: Unsatisfied dependency expressed through method <span class="token string">&#39;basicAuthenticationFilter&#39;</span> parameter <span class="token number">0</span><span class="token punctuation">;</span> nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name <span class="token string">&#39;nacosAuthConfig&#39;</span> defined <span class="token keyword">in</span> URL <span class="token punctuation">[</span>jar:file:/opt/server/nacos/nacos-8848/target/nacos-server.jar<span class="token operator">!</span>/BOOT-INF/lib/nacos-plugin-default-impl-2.2.1.jar<span class="token operator">!</span>/com/alibaba/nacos/plugin/auth/impl/NacosAuthConfig.class<span class="token punctuation">]</span>: Unsatisfied dependency expressed through constructor parameter <span class="token number">1</span><span class="token punctuation">;</span> nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name <span class="token string">&#39;tokenManagerDelegate&#39;</span><span class="token builtin class-name">:</span> Unsatisfied dependency expressed through field <span class="token string">&#39;jwtTokenManager&#39;</span><span class="token punctuation">;</span> nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name <span class="token string">&#39;jwtTokenManager&#39;</span> defined <span class="token keyword">in</span> URL <span class="token punctuation">[</span>jar:file:/opt/server/nacos/nacos-8848/target/nacos-server.jar<span class="token operator">!</span>/BOOT-INF/lib/nacos-plugin-default-impl-2.2.1.jar<span class="token operator">!</span>/com/alibaba/nacos/plugin/auth/impl/token/impl/JwtTokenManager.class<span class="token punctuation">]</span>: Instantiation of bean failed<span class="token punctuation">;</span> nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate <span class="token punctuation">[</span>com.alibaba.nacos.plugin.auth.impl.token.impl.JwtTokenManager<span class="token punctuation">]</span>: Constructor threw exception<span class="token punctuation">;</span> nested exception is java.lang.IllegalArgumentException: the length of secret key must great than or equal <span class="token number">32</span> bytes<span class="token punctuation">;</span> And the secret key  must be encoded by base64.Please see https://nacos.io/zh-cn/docs/v2/guide/user/auth.html
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="http://image.edkso.cn/blog/image-20230409225218791.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案" aria-hidden="true">#</a> 解决方案</h2><blockquote><p>Failed to instantiate (con. alibaba, nacos, olugin, auth. imol, token. imol. JitTokenManager]: Constructor threw exception;</p></blockquote><p>可以看到提示我们一个秘钥是必须配置的，我们打开这个网址</p><table><thead><tr><th>参数</th><th style="text-align:left;">默认值</th><th>启止版本</th><th>说明</th></tr></thead><tbody><tr><td>nacos.core.auth.plugin.<br>nacos.token.secret.key</td><td style="text-align:left;">SecretKey01234567<br>89012345678901234567<br>89012345678901234567<br>890123456789(2.2.0.1后无默认值)</td><td>2.1.0 ~ latest</td><td>默认鉴权插件用于生成用户登陆临时accessToken所使用的密钥，<strong>使用默认值有安全风险</strong></td></tr></tbody></table><p>然后我们修改 conf/application.properties 文件</p><p>找到nacos.core.auth.plugin.nacos.token.secret.key这个字段给他赋值临时值：SecretKey01234567<br>8901234567890123456789012345678901234567890123456789</p><blockquote><p>不要用在生产环境，临时使用，官方在可视化界面登录的时候也提醒了</p></blockquote><img src="http://image.edkso.cn/blog/image-20230409230403557.png" alt="image-20230409230403557" style="zoom:50%;">`,13),c=[o];function r(i,p){return n(),e("div",null,c)}const d=a(s,[["render",r],["__file","Nacos2.2版本Tomcat启动报错.html.vue"]]);export{d as default};
